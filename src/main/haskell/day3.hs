test_contents = "..##......." : "#...#...#.." : ".#....#..#." : "..#.#...#.#" : ".#...##..#." : "..#.##....." : ".#.#.#....#" : ".#........#" : "#.##...#..." : "#...##....#" : ".#..#...#.#" : []
contents = "..#......###....#...##..#.#...." : ".#.#.....#.##.....###...##...##" : "..#.#..#...........#.#..#......" : "..#......#..........###........" : "...#..###..##.#..#.......##..##" : "......#.#.##...#...#....###...." : "..........##.....##..##......#." : "......#...........#............" : "#....#..........#.............." : ".#........##.............###.##" : "....#.........#.......#.#....##" : "#.#..#..#..#.......#...#....##." : ".#........#......#.##.......#.." : "..#.....#####.....#....#..#..##" : ".......#..##.......#......#.###" : "..#.#...#......#.##...#........" : "##...................#...##..#." : "......#...#.##...##.#......#..#" : ".#.................#..##...#..." : "...#.....#.......##.....#.#...." : ".......#.#......#.....#..#..##." : "..........#........#..........." : "..#.#.........................." : ".#.##..#.#...#...#.........#..." : ".....#....#.....#..#.....#....." : "...#.#.#.....#.#..#.......#..#." : ".....#...###...##...#......##.." : "#.###......#.#...#.#.#..###...." : "#.....#..##......#..........#.#" : "#...............#........#.#..#" : ".....#..#.........#......##.#.." : ".....#.##.##..#..##............" : "...#......##...............#.#." : ".#..#.#............##.#........" : "#.....#..###.............##.#.." : "...##..#.#..#...........#..#..." : "#....#.........#.#............." : "##.#.........#..###......#.#..#" : "...#...#......#.#.#.##..#.##..." : ".....##............#.##.##..#.." : "....#................#.##..#..#" : "...#..#.......#...#..#........#" : "....#...#...#................#." : "....##...............#.#...#..." : ".#.....###...#.......#.##......" : "....######.#..............###.#" : ".#..#.........##..............." : "................##.#..#....###." : ".......#............#.#..#..#.." : "......#.#...............##.#..." : "...#..####.#...#..#..#......#.." : "....#.#...#.....#.........#..##" : ".##..#...#......##....##.#.#..." : ".##.#.........##...#....#......" : "..#.#..#...#.#..#.......#...#.#" : ".........#..#.....##..#........" : "..#......#..##.....#..#...###.." : "..#...#....#.#..#..#.#.#..#.#.." : "...#..#####.....#......#......." : "#.#............#......#..#...#." : ".........#..........###.......#" : "......#....#..#.##.#......#..#." : "...........##.#....#.#..#......" : "..#...................#..#.#..." : "#....##.............##....#...#" : "##..#....#.........#..........#" : "....#.#.#...#..#........#.##..#" : "...............#...#..##..#...." : ".##.......#.......#...........#" : "#.........................##..." : "#........#.#..#..##..####.#...." : "...................##.....###.." : ".#.......#..#......#......#...#" : "..#.........#...#..........#..." : "..........#......#....#........" : ".#......#..#...#..#...##....##." : "...#.#..#..#......#.....##.####" : ".......#.#....#.......#........" : "#...#.#...##..##.#......#......" : ".#.........#..................." : "...#..........#.#......#......." : "...#.....##....#..........#...." : ".#..........##..#..#..##....#.#" : ".##.#..........#...#.##.......#" : "#...###....#..#.#...#..#......." : "..................##..........." : "..#...##.#...........#....#.##." : "..#......#..##..#....##..#...#." : "..#....#.....#.##..#.......#..#" : "#...#....#..#.#....#......##..." : ".......##..#..........#........" : "..#.............##.#.....#...#." : "...............#....#...#...##." : "##...........#.......#.##......" : "#..#...........#.........#....." : "....###.............###.##..##." : ".........#.#.....###.......#..." : "..#.##....#.#..........#....#.." : "#........#....##...#..#........" : "......#..........###..#.#......" : ".....#.#......##.....#..##...#." : ".#.......#......#...#...#...#.#" : ".#..........##.......#.....##.#" : "###.#...#....#.....#...#......#" : "..#.#.#..#.##.#..#............." : ".....#........................." : ".#..###..#...#...#..#..#...#.#." : "#................##...##.##...." : "......#...#...#..........#...#." : "..........#.....##............." : "..#.#......#........#.......#.." : "........##.............#......." : ".......#......#.##.#..#........" : "#.#.#....#........#..........#." : "##..##......#..#..#.....#.#..##" : "##..#..........#..............." : "#.....##...#.#......#.......#.#" : "#.....#...#....#..#.....##....." : "##..........#.#.....#....#...##" : "..##.###..#.....#.......#...#.." : ".#.#.......#......###........#." : ".#..............#.#..###......." : ".#....#..##.........#..#.#....." : "....#....#.#....#..#.......##.#" : "#.......#.......#.........#...." : "...#....#....#.....##..#..#.#.#" : "........#....#...........#....." : ".#......##.#.#.##.............." : "#..#.#.....##........#........#" : "##...#.#.......##.......#...#.." : "#...#.....#.##...##.#.....#...." : "....#..##...#........#.#...#..." : "...#....#.#.#..###...##.#.....#" : "......#..#.....#..#........##.." : ".......#.....#.#.........#.#..#" : "..#.......#.#.#.#.#....#.##...#" : ".#...#........#..##..#......#.." : ".#..#............#...#..#.#...." : "...##......#......#............" : "..#...#.#.....#.....#..##.#...." : ".#......#.#......#..#.#........" : "..#..........##...#.#.....#..#." : "#...#.....#..#...#............." : "..##.................#....#...." : ".#....#.......#..##....#......#" : ".#....###............##....##.#" : "##..#........#..#...#.......#.." : ".....#.....#.#.#.##.........#.." : ".......#..#....#...#...#......." : "...#...#...#.#.#..#.#.....#...." : "#.#........#..#.##..#..###....." : "..................#..#........." : "#.#.....#..##.........#.......#" : "###..#.......#..............#.." : "......#..#.....###..........#.." : "....#.#...#..#...........#.#..." : "...#.....#.......#.....#.#....." : "#.....##..#......##...........#" : "#...###...........##..#...#.##." : "......##.##.#...#..#....#......" : "...#.#......##.#......##....#.#" : "..............#.#.###.......#.." : "........#....#.......##..#..###" : "...#.....##.#....#......##..#.#" : "..##........#.....#.#..#...#..." : ".#..#.##.........#.....#...#..#" : "..#..#....#...........#........" : ".#...#....................#...." : "##.....##....#.............#.#." : "....#.#..#.#..#.#.#..........##" : ".............##.#.....#..#..#.." : ".#....#.....##...#.###........." : "..#........#........#.#..###..." : ".##....#...#...#.......#...#.#." : "..#...#...#..##........#..#...." : "..##.#..#..#.....#......#.#..#." : ".#........#..#....#..#........." : "..#.#.....#.##..#........###.#." : ".....#.##.....##.#............." : "#.........#.......#...##...#..." : "..#.##.#..#..#............#...." : ".##....#..#............#.....#." : "###........##.....##.#...#....." : "#......##..##.#.#.#.#.#.#..##.." : ".....###.....#....#......#....#" : "........#.........##...#....#.#" : ".#.#.....#.#..#..##......#...#." : "...#.##....#..#.###..#..##....." : "....#..........##..#..#..#..#.." : "...#..#.##..#..#....#.........#" : ".....#..###.#.....#.....#..#..." : "......#...#....#.##...#.#......" : ".#.###..##.....##.##......##..." : ".....#.#...........#.#........." : "#........#...#..#......##.#...." : "..#.......##....##....#.##.#..#" : "...###.#.........#......#.....#" : "..#.##..#....#.....##...#.##..." : "....##.##.............#...#...." : "##..#...#..#..#..#............." : ".....#.....#.....#............." : "...#.##.......#..#.#.....#....#" : "#.....##.........#......##....." : ".....##..........#..#...#..#..." : "#...###....#.......#...##......" : ".#....#..#......#.....#...#.#.." : "#........#.#.#...#.....###.#.##" : "##...#...##..#..#....#........." : "....#............#..#.....#...." : "#......#.........##....#......." : ".#..#..#........#.............#" : ".##..........#......#.......#.." : "#............#..#....#........." : "....#.#.....#.##...#.....#.#..." : "...#.#..#...##..#...#.#.#......" : "#....#..#.........##..#.#.#..##" : ".#...#..............#.......#.." : "#...#.....#.#........##......##" : "...#....##.####.#.........#.#.#" : "....###.#..#............#.#..#." : "....#......#...#......##.#.#.#." : ".....#..#.#.##.#...##.........." : "##..#...#.#...###.............#" : "....#...#..#.....#.#..#..#..#.." : "#..........####......#.....###." : ".........#........#.##.#...#..." : ".........#..........#.#..###..." : ".....##........##.........#...#" : "..##....#...#.......##........." : ".....#.#......##....#...#...#.." : ".##..#..##....................." : ".......#...#..#..#...##....#..." : ".#...#.......###...#..#..#....." : ".......#.....##.##.#.......#..#" : ".##......#...#....#..#......##." : ".##....#..#....#...#...#......." : ".........##..#..#.#.#.....##..." : "...#..............#..#.....####" : ".#.#.#..#.......#.......#......" : "..#.#......#..........#........" : ".#...#.#..#.......#..#..#..#..." : ".......##.#...#..#....#.....#.." : ".##...##....##...#........####." : "....#.#..##....#...#....#.#...." : ".....#.....#..#..#.#.##..#....." : "..#....#..............#....#..." : "..#.#.#.....##.#.....#..##....." : "....#.....#....#...#...#..#.#.." : "#...#...........#..#..#........" : "...#.#..#.........##.#...#..##." : "......#.#.........#.#...#......" : "......#..##.###......##.#....#." : ".....#...#..#.......#.........." : ".#...#.......#.....###......#.." : "...........##.....#..#..#....#." : "..#....#..#...#......#.......#." : "..#...#...#.#..#....#...#......" : ".......#....###.####...###.#..." : "#.##.#.......#.......#....#.#.#" : ".##..........#.....#..###......" : ".....#...........#.##..#....#.." : "........##.....#.#........##..." : "#..#..#..................##...." : "#...###..........#............." : ".......#.#.......#.#.......##.." : ".....#.#...#....#...####.....#." : "..##.....##.......#....#......." : "##..........#...#..##....##...." : "..........#..#......#........#." : "##..#....#..#....#.....##....#." : "##.##.....#...##.##.......#...." : "..#..#.###.#..##.#..#..#...#..." : ".#..#.....#........#...##.#...." : "..#..#.....#.#......##.#.#....." : ".#..##...#.#....#...#...#.#.##." : ".........#...#....###.#.....#.." : "...........###.#.#..#..#...#.#." : "##...#......##...........#..#.." : ".........##..#...#.......#....." : "#......#.#..........#..#......." : "...#.................#....#...." : "#....#......................##." : "##.......#..#......#.#...###.#." : "..#....#..#.#......#..........." : "...#...........###.#.#........." : "..#..##.....#.....##...##......" : "..#..#.#.#.#..#..#..##....#...#" : "#......##.....##..##.##...#...." : "#.....#.....#.#........#......." : ".#.....#.................#....#" : ".###....#...#............#.#.#." : ".#...#.#......#.#.............." : "....#...#......#.....#.......#." : "........#.....#..........#....#" : "#..#......#...#...#.........#.." : "#....#......#...##.#...#...#..." : "#...#....#....#..#..#.....#..#." : "#......##..#..#.#.#..#.#......." : "..#..#...............#...##...#" : "............#..............#.##" : ".#.#.#......##.......#.......#." : "....#.........##.......#...###." : ".......#.#...#.#.#.......#....." : "....#..#..#...#....#.##.#.##..." : "...##.##.#...#......#.........." : "#.....#...#.#...#.##..##.#....." : ".......#.....#...#.#...##.#...." : ".#.............#.....#....##..#" : "##......#.......#...#....#....." : ".###......#.................#.." : "#.#......##.........##..#......" : "...#....#..........#.#........." : "..##..#.........#.............." : ".....#...#..................#.#" : ".............#.........#...#..#" : "....#....#......#.#.......#...#" : "#..#............#.#.......#...#" : "..#.....#............#........." : ".#.....................###....#" : "........#.####.........#.#.#..." : "#...........##...#.........#..#" : "...........#..#......#...#.#..." : "....##...##.....#.....#........" : []

get_indices :: [[Char]] -> Int -> Int -> [(Int, Int)]
get_indices contents xslope yslope = zip vertical horizontal where
  height = length contents
  width =  length (contents !! 0)
  vertical = [0, xslope .. length contents - 1]
  horizontal = map (\x -> x `mod` width) [0, yslope ..]

count_trees :: Int -> Int -> [[Char]] -> Int
count_trees xslope yslope contents = length y where
  both = get_indices contents xslope yslope
  x = map (\(x, y) -> contents !! x !! y) both
  y = filter (\x -> x == '#') x

all_trees = map (\(x, y) -> count_trees x y contents) [(1, 1), (1, 3), (1, 5), (1, 7), (2, 1)]
product_of_all_trees = product all_trees
